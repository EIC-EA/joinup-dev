# Development configs and commands

scss:
  import_dir: ${joinup.theme_dir}/prototype/scss
  input: ${scss.import_dir}/app.scss
  output_dir: ${joinup.theme_dir}/css
  output: ${scss.output_dir}/style.min.css
  style: compressed

commands:
  # Compiles SCSS to CSS.
  dev:compile-scss:
    - task: mkdir
      dir: ${scss.output_dir}
    - task: run
      command: assets:compile-scss
      arguments:
        - ${scss.input}
        - ${scss.output}
      options:
        style: ${scss.style}
        import-dir: ${scss.import_dir}

  # Downloads all backends backups.
  dev:download-databases:
    - { task: "run", command: "mysql:download-dump" }
    - { task: "run", command: "virtuoso:download-snapshot" }
    - { task: "run", command: "solr:download-snapshot" }

  # Restores all backends from backup.
  dev:restore-databases:
    - task: run
      command: solr:restore
    - task: run
      command: virtuoso:restore
    - task: exec
      command: ${phing.bin}
      arguments:
        - disable-webtools-geocoding-cache
    - task: run
      command: toolkit:install-dump

  # Rebuilds the dev environment by restoring backups and applying updates.
  dev:rebuild-environment:
    - task: run
      command: dev:restore-databases
    - task: run
      command: toolkit:run-deploy
